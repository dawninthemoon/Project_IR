
<AIPackage Name="CommonChasePackage" DefaultState="Entry">

    <GlobalVariable Name="gv_targetDistance" Value="1.5"/>
    <GlobalVariable Name="gv_targetOutDistance" Value="2.0"/>

    <AIState>
        <Entry UpdateTime="0.3" TargetSearchType="Near" TargetSearchRange="gv_targetDistance" SearchIdentifier="Player">
            <Event_OnExecute>
                <AIEvent Type="SetAction" Action="AC_Idle"/>
            </Event_OnExecute>

            <Branch Condition="(TargetDistanceHorizontal < gv_targetDistance) && TargetExists" Execute="Chase"/>
        </Entry>

        <Chase UpdateTime="0.0" TargetSearchType="Near" TargetSearchRange="gv_targetOutDistance" SearchIdentifier="Player">
            <Event_OnExecute>
                <AIEvent Type="SetDirectionToTarget"/>
                <AIEvent Type="SetAction" Action="AC_Move"/>
            </Event_OnExecute>
            
            <Event_OnUpdate>
                <AIEvent Type="SetDirectionToTarget"/>
            </Event_OnUpdate>

            <Branch Condition="OnGround == false" Execute="Chase_Air"/>
            <Branch Condition="(TargetExists == false) || (TargetDistanceHorizontal >= gv_targetOutDistance)" Execute="Entry"/>
            <Branch Condition="(TargetDistanceHorizontal < 0.3)" Execute="AttackTarget"/>
            <Branch Condition="OnGround && (TargetDistanceVertical > 0.3)" Execute="Chase_Jump"/>
        </Chase>

        <Chase_Jump UpdateTime="0.3" TargetSearchType="Near" TargetSearchRange="gv_targetOutDistance" SearchIdentifier="Player">
            <Event_OnExecute>
                <AIEvent Type="SetDirectionToTarget"/>
            </Event_OnExecute>
            
            <Event_OnUpdate>
                <AIEvent Type="SetDirectionToTarget"/>
                <AIEvent Type="SetAction" Action="AC_JumpStart"/>
            </Event_OnUpdate>

            <Branch Condition="true" Execute="Chase_Air"/>
            <Branch Condition="(TargetExists == false) || (TargetDistanceHorizontal >= gv_targetOutDistance)" Execute="Entry"/>
        </Chase_Jump>

        <Chase_Air UpdateTime="0.0" TargetSearchType="Near" TargetSearchRange="gv_targetOutDistance" SearchIdentifier="Player">
            <Event_OnExecute>
                <AIEvent Type="SetDirectionToTarget"/>
            </Event_OnExecute>
            
            <Event_OnUpdate>
                <AIEvent Type="SetDirectionToTarget"/>
            </Event_OnUpdate>

            <Branch Condition="OnGround" Execute="Chase"/>
            <Branch Condition="(TargetExists == false) || (TargetDistanceHorizontal >= gv_targetOutDistance)" Execute="Entry"/>
        </Chase_Air>

        <AttackTarget UpdateTime="0.0" TargetSearchType="Near" TargetSearchRange="gv_targetDistance" SearchIdentifier="Player">
            <Event_OnExecute>
                <AIEvent Type="SetAction" Action="AC_Attack"/>
            </Event_OnExecute>

            <Branch Condition="End == true" Execute="Chase"/>
        </AttackTarget>

    </AIState>
</AIPackage>